<div class="card shadow-sm mb-4">
  <div class="card-body">
    <h4 class="card-title"><%= @user.name.present? ? @user.name : "退会済みユーザー" %> さんの詳細</h4>
    <p><strong>Email:</strong> <%= @user.email %></p>
    <p><strong>登録日:</strong> <%= l @user.created_at, format: :long %></p>
  </div>
</div>

<div class="card shadow-sm mb-4">
  <div class="card-header bg-light">
    <i class="fas fa-pen"></i> 投稿一覧
  </div>
  <div class="card-body">
    <% if @user.posts.any? %>
      <ul>
        <% @user.posts.each do |post| %>
          <li>
            <%= link_to post.title, admin_post_path(post) %> 
            <small class="text-muted">（<%= l post.created_at, format: :short %>）</small>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-muted">投稿はありません</p>
    <% end %>
  </div>
</div>

<div class="card shadow-sm mb-4">
  <div class="card-header bg-light">
    <i class="fas fa-comment"></i> コメント一覧
  </div>
  <div class="card-body">
    <% if @user.comments.any? %>
      <ul>
        <% @user.comments.each do |comment| %>
          <li>
            <%= truncate(comment.body, length: 50) %>
            <small class="text-muted">（投稿: <%= link_to comment.post.title, admin_post_path(comment.post) %>）</small>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-muted">コメントはありません</p>
    <% end %>
  </div>
</div>

<div class="card shadow-sm mb-4">
  <div class="card-header bg-light">
    <i class="fas fa-users"></i> 参加コミュニティ一覧
  </div>
  <div class="card-body">
    <% if @user.communities.any? %>
      <ul>
        <% @user.communities.each do |community| %>
          <li>
            <%= link_to community.name, admin_community_path(community) %>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-muted">参加中のコミュニティはありません</p>
    <% end %>
  </div>
</div>

<div class="d-flex gap-2">
  <%= link_to "削除", admin_user_path(@user), method: :delete, data: { confirm: "このユーザーを削除してもよろしいですか？ 投稿・コメントは残ります。" }, class: "btn btn-danger" %>
  <%= link_to "一覧に戻る", admin_users_path, class: "btn btn-secondary" %>
</div>