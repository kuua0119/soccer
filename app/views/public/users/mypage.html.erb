<div class="container my-5">
  <div class="card shadow-lg mb-5">
    <div class="card-header p-0">
      <img src="/assets/banner.jpg" class="img-fluid w-100" alt="バナー画像">
    </div>
    <div class="card-body text-center">
      <% if current_user.avatar.attached? %>
        <%= image_tag current_user.avatar.variant(resize_to_fill: [120, 120]), class: "rounded-circle mb-3", alt: "プロフィール画像" %>
      <% else %>
        <%= image_tag "profile.jpg", class: "rounded-circle mb-3", width: 120, height: 120, alt: "デフォルトプロフィール画像" %>
      <% end %>
      <h3 class="mb-1"><%= current_user.name %></h3>

      <div class="d-flex justify-content-center gap-3 mt-2">
        <%= link_to "#{current_user.following.count} フォロー", following_user_path(current_user), class: "btn btn-outline-secondary btn-sm" %>
        <%= link_to "#{current_user.followers.count} フォロワー", followers_user_path(current_user), class: "btn btn-outline-secondary btn-sm" %>
      </div>

      <p class="text-muted mt-3">
        <%= current_user.introduction.present? ? simple_format(current_user.introduction) : "紹介文はまだ登録されていません" %>
      </p>
      
      <a href="<%= edit_user_profile_path(current_user.id) %>" class="btn btn-outline-primary btn-sm">プロフィール編集</a>

      <div class="mt-3">
        <%= link_to "退会する", destroy_user_profile_path(current_user),method: :delete,data: { confirm: "本当に退会しますか？アカウント情報は完全に削除されます。" },class: "btn btn-danger btn-sm" %>
      </div>
    </div>
  </div>

  <div class="card shadow-sm mb-4">
    <div class="card-header bg-light">
      <i class="fas fa-pen"></i> あなたの投稿
    </div>
    <div class="card-body">
      <% if current_user.posts.any? %>
        <% current_user.posts.each do |post| %>
          <p><%= post.title %></p>
        <% end %>
      <% else %>
        <p class="text-muted">まだ投稿はありません</p>
      <% end %>
    </div>
  </div>

  <div class="card shadow-sm">
    <div class="card-header bg-light">
      <i class="fas fa-users"></i> 参加中のコミュニティ
    </div>
    <div class="card-body">
      <% if current_user.communities.any? %>
        <% current_user.communities.each do |community| %>
          <p><%= community.community_name %></p>
        <% end %>
      <% else %>
        <p class="text-muted">まだ参加しているコミュニティはありません</p>
      <% end %>
    </div>
  </div>
</div>